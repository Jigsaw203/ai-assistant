<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>AIåŠ©æ‰‹ç®¡ç†ç³»ç»Ÿ</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				background: #f5f7fa;
				color: #333;
			}

			.container {
				display: flex;
				min-height: 100vh;
			}

			/* ä¾§è¾¹æ  */
			.sidebar {
				width: 240px;
				background: white;
				box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
				padding: 20px 0;
			}

			.logo {
				display: flex;
				align-items: center;
				padding: 0 24px 30px;
				font-size: 18px;
				font-weight: bold;
				color: #4285f4;
			}

			.logo::before {
				content: "ğŸ¤–";
				margin-right: 8px;
				font-size: 24px;
			}

			.nav-menu {
				list-style: none;
			}

			.nav-item {
				margin: 4px 12px;
			}

			.nav-link {
				display: flex;
				align-items: center;
				padding: 12px 16px;
				text-decoration: none;
				color: #666;
				border-radius: 8px;
				transition: all 0.3s ease;
			}

			.nav-link:hover,
			.nav-link.active {
				background: #e3f2fd;
				color: #4285f4;
			}

			.nav-icon {
				width: 20px;
				height: 20px;
				margin-right: 12px;
				font-size: 18px;
			}

			/* ä¸»å†…å®¹åŒºåŸŸ */
			.main-content {
				flex: 1;
				padding: 24px;
			}

			/* é¡¶éƒ¨æ  */
			.header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 24px;
			}

			.search-box {
				display: flex;
				align-items: center;
				background: white;
				border: 1px solid #e0e0e0;
				border-radius: 24px;
				padding: 8px 16px;
				width: 300px;
			}

			.search-box input {
				border: none;
				outline: none;
				margin-left: 8px;
				flex: 1;
			}

			.user-info {
				display: flex;
				align-items: center;
				gap: 16px;
			}

			.user-avatar {
				width: 32px;
				height: 32px;
				border-radius: 50%;
				background: #4285f4;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-weight: bold;
			}

			/* å·¥ä½œå°æ¨ªå¹… */
			.workspace-banner {
				/* ä¿®æ”¹åçš„èƒŒæ™¯ï¼šä½¿ç”¨å›¾ç‰‡ image_0c532c.png ä½œä¸ºèƒŒæ™¯ */
				background-image:
					/* linear-gradient(135deg, rgba(102, 126, 234, 0.6) 0%, rgba(118, 75, 162, 0.6) 100%), */
					url('bg-img.png');
				/* **é‡è¦ï¼šè¯·ç¡®ä¿è¿™é‡Œçš„å›¾ç‰‡è·¯å¾„æ˜¯æ­£ç¡®çš„** */
				background-size: cover;
				/* ç¡®ä¿å›¾ç‰‡è¦†ç›–æ•´ä¸ªæ¨ªå¹…åŒºåŸŸ */
				background-position: center;
				/* ç¡®ä¿å›¾ç‰‡å±…ä¸­æ˜¾ç¤º */
				background-repeat: no-repeat;
				/* ä¸é‡å¤å¹³é“º */

				border-radius: 16px;
				padding: 32px;
				color: white;
				margin-bottom: 24px;
				position: relative;
				overflow: hidden;
			}

			.banner-content h2 {
				font-size: 24px;
				margin-bottom: 8px;
			}

			.banner-content p {
				opacity: 0.9;
				margin-bottom: 20px;
			}

			.btn-primary {
				background: rgba(255, 255, 255, 0.2);
				border: 1px solid rgba(255, 255, 255, 0.3);
				color: white;
				padding: 10px 20px;
				border-radius: 8px;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.btn-primary:hover {
				background: rgba(255, 255, 255, 0.3);
			}

			/* ä»ªè¡¨ç›˜ä¸Šçš„æ–°å»ºä»»åŠ¡æŒ‰é’® */
			.btn-primary.new-task {
				background: #4285f4;
				padding: 6px 12px;
				border: none;
				/* ç§»é™¤æ¨ªå¹…æŒ‰é’®å¸¦çš„è¾¹æ¡† */
			}

			.banner-illustration {
				position: absolute;
				right: 40px;
				top: 50%;
				transform: translateY(-50%);
				font-size: 120px;
				opacity: 0.7;
			}

			/* ç»Ÿè®¡å¡ç‰‡ */
			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 20px;
				margin-bottom: 24px;
			}

			.stat-card {
				background: white;
				border-radius: 12px;
				padding: 24px;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
				position: relative;
				overflow: hidden;
			}

			.stat-icon {
				width: 48px;
				height: 48px;
				border-radius: 12px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 24px;
				margin-bottom: 16px;
			}

			.stat-number {
				font-size: 28px;
				font-weight: bold;
				margin-bottom: 4px;
			}

			.stat-label {
				color: #666;
				font-size: 14px;
			}

			.blue {
				background: #e3f2fd;
				color: #1976d2;
			}

			.green {
				background: #e8f5e8;
				color: #388e3c;
			}

			.orange {
				background: #fff3e0;
				color: #f57c00;
			}

			.purple {
				background: #f3e5f5;
				color: #7b1fa2;
			}

			/* ä¸»è¦å†…å®¹åŒºåŸŸ */
			.content-grid {
				display: grid;
				grid-template-columns: 2fr 1fr;
				gap: 24px;
			}

			.content-grid.two-cols {
				grid-template-columns: 1fr 1fr;
			}

			.content-section {
				background: white;
				border-radius: 12px;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
			}

			.section-header {
				padding: 20px 24px;
				border-bottom: 1px solid #f0f0f0;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.section-title {
				font-size: 16px;
				font-weight: 600;
			}

			/* å›¾è¡¨åŒºåŸŸ */
			.chart-container {
				padding: 24px;
				height: 300px;
				position: relative;
			}

			.chart-placeholder {
				width: 100%;
				height: 100%;
				background: linear-gradient(45deg, #f8f9fa, #e9ecef);
				border-radius: 8px;
				display: flex;
				align-items: center;
				justify-content: center;
				color: #666;
				font-size: 14px;
				flex-direction: column;
			}

			/* ä»»åŠ¡é˜Ÿåˆ— */
			.schedule-list {
				padding: 0 24px 24px;
			}

			.schedule-item {
				display: flex;
				align-items: center;
				padding: 12px 0;
				border-bottom: 1px solid #f5f5f5;
			}

			.schedule-item:last-child {
				border-bottom: none;
			}

			.schedule-time {
				width: 60px;
				font-size: 12px;
				color: #999;
			}

			.schedule-content {
				flex: 1;
				margin-left: 16px;
			}

			.schedule-title {
				font-size: 14px;
				font-weight: 500;
				margin-bottom: 2px;
			}

			.schedule-subtitle {
				font-size: 12px;
				color: #999;
			}

			.schedule-status {
				width: 8px;
				height: 8px;
				border-radius: 50%;
				margin-right: 12px;
			}

			.status-waiting {
				background: #ffa726;
			}

			.status-running {
				background: #66bb6a;
			}

			.status-completed {
				background: #42a5f5;
			}

			.status-failed {
				background: #d32f2f;
			}

			/* ä»»åŠ¡åˆ—è¡¨æŒ‰é’®æ ·å¼ */
			.btn-task {
				padding: 4px 8px;
				border-radius: 8px;
				cursor: pointer;
				border: none;
				font-size: 12px;
				margin-left: 5px;
				transition: background 0.2s;
			}

			.btn-assign-auto {
				background: #e8f5e8;
				color: #388e3c;
			}

			.btn-multi-assign {
				background: #f3e5f5;
				color: #7b1fa2;
			}

			.btn-mark-complete {
				background: #e3f2fd;
				color: #1976d2;
			}

			.btn-mark-failed {
				background: #ffebee;
				color: #d32f2f;
			}

			/* åŠ©æ‰‹ç®¡ç†æŒ‰é’®æ ·å¼ */
			.btn-assistant {
				padding: 6px 10px;
				margin-left: 5px;
				font-size: 12px;
			}

			.btn-start-service {
				background: #e8f5e8;
				color: #388e3c;
			}

			.btn-stop-service {
				background: #fff3e0;
				color: #f57c00;
			}

			.btn-edit-assistant {
				background: #e3f2fd;
				color: #1976d2;
			}

			.btn-delete-assistant {
				background: #ffebee;
				color: #d32f2f;
			}


			/* æ¨¡æ€æ¡† */
			.modal {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				z-index: 1000;
			}

			.modal-content {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: white;
				border-radius: 12px;
				width: 90%;
				max-width: 600px;
				max-height: 80vh;
				overflow-y: auto;
			}

			.modal-header {
				padding: 24px;
				border-bottom: 1px solid #f0f0f0;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.close-btn {
				background: none;
				border: none;
				font-size: 24px;
				cursor: pointer;
				color: #999;
			}

			.modal-body {
				padding: 24px;
			}

			.form-group {
				margin-bottom: 16px;
			}

			.form-group label {
				display: block;
				margin-bottom: 8px;
				font-weight: 500;
			}

			.form-group input,
			.form-group select,
			.form-group textarea {
				width: 100%;
				padding: 10px 12px;
				border: 1px solid #e0e0e0;
				border-radius: 8px;
				outline: none;
			}

			.form-group input:focus,
			.form-group select:focus,
			.form-group textarea:focus {
				border-color: #4285f4;
			}

			.checkbox-group {
				display: flex;
				align-items: center;
				margin-top: 10px;
			}

			.checkbox-group input[type="checkbox"] {
				width: auto;
				margin-right: 8px;
			}

			.btn-group {
				display: flex;
				gap: 12px;
				justify-content: flex-end;
				margin-top: 24px;
			}

			.btn {
				padding: 10px 20px;
				border-radius: 8px;
				cursor: pointer;
				border: none;
				font-size: 14px;
			}

			.btn-cancel {
				background: #f5f5f5;
				color: #666;
			}

			.btn-save {
				background: #4285f4;
				color: white;
			}

			/* è¡¨æ ¼æ ·å¼ */
			.table-container {
				padding: 24px;
				overflow-x: auto;
			}

			.table {
				width: 100%;
				border-collapse: collapse;
			}

			.table th,
			.table td {
				padding: 12px 16px;
				text-align: left;
				border-bottom: 1px solid #f0f0f0;
			}

			.table th {
				background: #f8f9fa;
				font-weight: 600;
				color: #666;
			}

			.status-badge {
				padding: 4px 8px;
				border-radius: 4px;
				font-size: 12px;
				font-weight: 500;
			}

			.status-online {
				background: #e8f5e8;
				color: #388e3c;
			}

			.status-offline {
				background: #ffebee;
				color: #d32f2f;
			}

			.status-waiting {
				background: #fff3e0;
				color: #f57c00;
			}

			.status-running {
				background: #e3f2fd;
				color: #1976d2;
			}

			.status-completed {
				background: #e8f5e8;
				color: #388e3c;
			}

			.status-failed {
				background: #ffebee;
				color: #d32f2f;
			}


			/* å“åº”å¼è®¾è®¡ */
			@media (max-width: 768px) {
				.container {
					flex-direction: column;
				}

				.sidebar {
					width: 100%;
					height: auto;
				}

				.content-grid {
					grid-template-columns: 1fr;
				}

				.stats-grid {
					grid-template-columns: repeat(2, 1fr);
				}

				#taskChart {
					max-height: 250px;
				}
			}
		</style>
	</head>
	<body>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
		<div class="container">
			<aside class="sidebar">
				<div class="logo">AIå·¥ä½œå°</div>
				<nav>
					<ul class="nav-menu">
						<li class="nav-item">
							<a href="#dashboard" class="nav-link active" onclick="showSection('dashboard')">
								<span class="nav-icon"></span>
								æ•°æ®ä¸­å¿ƒ
							</a>
						</li>
						<li class="nav-item">
							<a href="#assistants" class="nav-link" onclick="showSection('assistants')">
								<span class="nav-icon"></span>
								æ™ºèƒ½åŠ©æ‰‹ç®¡ç†
							</a>
						</li>
						<li class="nav-item">
							<a href="#tasks" class="nav-link" onclick="showSection('tasks')">
								<span class="nav-icon"></span>
								ä»»åŠ¡ç®¡ç†
							</a>
						</li>
						<li class="nav-item">
							<a href="#logs" class="nav-link" onclick="showSection('logs')">
								<span class="nav-icon"></span>
								æ—¥å¿—ä¸­å¿ƒ
							</a>
						</li>
						<li class="nav-item">
							<a href="#stats" class="nav-link" onclick="showSection('stats')">
								<span class="nav-icon"></span>
								ç»Ÿè®¡ä¸­å¿ƒ
							</a>
						</li>
					</ul>
				</nav>
			</aside>

			<main class="main-content">
				<div id="dashboard-section" class="section">
					<div class="workspace-banner">
						<div class="banner-content">
							<h2>AIåŠ©æ‰‹ç®¡ç†å·¥ä½œå°</h2>
							<p>å¼€å¯åŠ©æ‰‹æ–°ä½“éªŒï¼Œæ™ºèƒ½åŒ–æ‚¨çš„ç®¡ç†å·¥ä½œæµç¨‹</p>
							<button class="btn-primary" onclick="openAssistantModal()">ç«‹å³å¼€å§‹</button>
						</div>
						<div class="banner-illustration">ğŸš€</div>
					</div>

					<div class="stats-grid" id="dashboard-stats-grid">
						<div class="stat-card">
							<div class="stat-icon blue">ğŸ¤–</div>
							<div class="stat-number" id="stat-assistant-count">--</div>
							<div class="stat-label">åŠ©æ‰‹æ€»æ•°</div>
						</div>
						<div class="stat-card">
							<div class="stat-icon green">âœ…</div>
							<div class="stat-number" id="stat-completed-count">--</div>
							<div class="stat-label">å·²å®Œæˆä»»åŠ¡</div>
						</div>
						<div class="stat-card">
							<div class="stat-icon orange">â³</div>
							<div class="stat-number" id="stat-running-count">--</div>
							<div class="stat-label">è¿è¡Œä¸­ä»»åŠ¡</div>
						</div>
						<div class="stat-card">
							<div class="stat-icon purple">ğŸ”„</div>
							<div class="stat-number" id="stat-log-count">--</div>
							<div class="stat-label">æ€»æ“ä½œæ—¥å¿—</div>
						</div>
					</div>

					<div class="content-grid">
						<div class="content-section">
							<div class="section-header">
								<div class="section-title">å¾…å¤„ç†ä»»åŠ¡é˜Ÿåˆ—</div>
								<button class="btn-primary new-task" onclick="openTaskModal()">+ æ–°å»ºä»»åŠ¡</button>
							</div>
							<div class="schedule-list" id="waiting-list">
								<div style="padding: 12px; color: #999; text-align: center;">æ­£åœ¨åŠ è½½å¾…å¤„ç†ä»»åŠ¡...</div>
							</div>
						</div>

						<div class="content-section">
							<div class="section-header">
								<div class="section-title">ä»Šæ—¥ä»»åŠ¡åˆ†å¸ƒ</div>
							</div>
							<div class="chart-container">
								<div class="chart-placeholder">
									<canvas id="taskChart"></canvas>
								</div>
							</div>
						</div>
					</div>

				</div>

				<div id="assistants-section" class="section" style="display: none;">
					<div class="content-section">
						<div class="section-header">
							<div class="section-title">æ™ºèƒ½åŠ©æ‰‹ç®¡ç†</div>
							<button class="btn-primary" onclick="openAssistantModal()">+ åˆ›å»ºæ–°åŠ©æ‰‹</button>
						</div>
						<div class="table-container">
							<table class="table">
								<thead>
									<tr>
										<th>ID</th>
										<th>åç§°</th>
										<th>ç±»å‹</th>
										<th>çŠ¶æ€</th>
										<th>è¯„åˆ†</th>
										<th>æ“ä½œ</th>
									</tr>
								</thead>
								<tbody id="assistants-table-body">
									<tr>
										<td colspan="6" style="text-align: center;">æ­£åœ¨åŠ è½½åŠ©æ‰‹æ•°æ®...</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<div id="tasks-section" class="section" style="display: none;">
					<div class="content-grid two-cols">
						<div class="content-section">
							<div class="section-header">
								<div class="section-title">è¿è¡Œä¸­ä»»åŠ¡ (Running)</div>
							</div>
							<div class="schedule-list" id="running-list">
								<div style="padding: 12px; color: #999; text-align: center;">æ­£åœ¨åŠ è½½è¿è¡Œä¸­ä»»åŠ¡...</div>
							</div>
						</div>

						<div class="content-section">
							<div class="section-header">
								<div class="section-title">å·²å®Œæˆä»»åŠ¡ (Completed)</div>
							</div>
							<div class="schedule-list" id="completed-list">
								<div style="padding: 12px; color: #999; text-align: center;">æ­£åœ¨åŠ è½½å·²å®Œæˆä»»åŠ¡...</div>
							</div>
						</div>
					</div>
				</div>

				<div id="logs-section" class="section" style="display: none;">
					<div class="content-section">
						<div class="section-header">
							<div class="section-title">æ“ä½œæ—¥å¿—ä¸­å¿ƒ</div>
						</div>
						<div class="table-container">
							<table class="table">
								<thead>
									<tr>
										<th>ID</th>
										<th>ä»»åŠ¡ID</th>
										<th>åŠ©æ‰‹ID</th>
										<th>æ“ä½œæè¿°</th>
										<th>çŠ¶æ€</th>
										<th>æ—¶é—´</th>
									</tr>
								</thead>
								<tbody id="logs-table-body">
									<tr>
										<td colspan="6" style="text-align: center;">æ­£åœ¨åŠ è½½æ—¥å¿—æ•°æ®...</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<div id="stats-section" class="section" style="display: none;">
					<div class="content-section">
						<div class="section-header">
							<div class="section-title">è¯¦ç»†ç³»ç»Ÿç»Ÿè®¡</div>
						</div>
						<div style="padding: 24px;">
							<div class="stats-grid">
								<div class="stat-card">
									<div class="stat-icon blue">ğŸ¤–</div>
									<div class="stat-number" id="stats-total-assistants">--</div>
									<div class="stat-label">åŠ©æ‰‹æ€»æ•°</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon green">âœ…</div>
									<div class="stat-number" id="stats-online-assistants">--</div>
									<div class="stat-label">åœ¨çº¿åŠ©æ‰‹</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon orange">âŒ</div>
									<div class="stat-number" id="stats-offline-assistants">--</div>
									<div class="stat-label">ç¦»çº¿åŠ©æ‰‹</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon purple">â­</div>
									<div class="stat-number" id="stats-avg-score">--</div>
									<div class="stat-label">å¹³å‡è¯„åˆ†</div>
								</div>
							</div>

							<div class="stats-grid" style="margin-top: 20px;">
								<div class="stat-card">
									<div class="stat-icon blue">ğŸ“‹</div>
									<div class="stat-number" id="stats-total-tasks">--</div>
									<div class="stat-label">ä»»åŠ¡æ€»æ•°</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon green">âœ”ï¸</div>
									<div class="stat-number" id="stats-completed-tasks">--</div>
									<div class="stat-label">å·²å®Œæˆä»»åŠ¡</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon orange">â³</div>
									<div class="stat-number" id="stats-running-tasks">--</div>
									<div class="stat-label">è¿è¡Œä¸­ä»»åŠ¡</div>
								</div>
								<div class="stat-card">
									<div class="stat-icon purple">âŒ›</div>
									<div class="stat-number" id="stats-waiting-tasks">--</div>
									<div class="stat-label">ç­‰å¾…ä¸­ä»»åŠ¡</div>
								</div>
							</div>

							<div class="content-section" style="margin-top: 24px; padding: 24px; text-align: center;">
								<h4 style="margin-bottom: 16px;">ä»»åŠ¡æˆåŠŸç‡</h4>
								<div style="font-size: 48px; font-weight: bold; color: #4285f4;"
									id="stats-success-rate">--</div>
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>

		<div id="assistant-modal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<h3 id="assistant-modal-title">åˆ›å»ºæ–°åŠ©æ‰‹</h3>
					<button class="close-btn" onclick="closeAssistantModal()">Ã—</button>
				</div>
				<div class="modal-body">
					<form id="assistant-form">
						<div class="form-group">
							<label for="assistantName">åŠ©æ‰‹åç§°</label>
							<input type="text" id="assistantName" name="assistantName" required>
						</div>
						<div class="form-group">
							<label for="assistantType">åŠ©æ‰‹ç±»å‹</label>
							<select id="assistantType" name="assistantType" required>
								<option value="æ–‡æœ¬ç”Ÿæˆ">æ–‡æœ¬ç”Ÿæˆ</option>
								<option value="å›¾åƒå¤„ç†">å›¾åƒå¤„ç†</option>
								<option value="æ•°æ®åˆ†æ">æ•°æ®åˆ†æ</option>
								<option value="è¯­éŸ³è¯†åˆ«">è¯­éŸ³è¯†åˆ«</option>
							</select>
						</div>
						<div class="form-group">
							<label for="assistantVersion">ç‰ˆæœ¬å·</label>
							<input type="text" id="assistantVersion" name="assistantVersion" value="1.0" required>
						</div>
						<div class="form-group">
							<label for="assistantScore">èƒ½åŠ›è¯„åˆ† (0-100)</label>
							<input type="number" id="assistantScore" name="assistantScore" min="0" max="100" value="80"
								required>
						</div>
						<div class="form-group checkbox-group">
							<input type="checkbox" id="assistantOnline" name="assistantOnline">
							<label for="assistantOnline" style="margin-bottom: 0;">æ˜¯å¦åœ¨çº¿</label>
						</div>
						<div class="btn-group">
							<button type="button" class="btn btn-cancel" onclick="closeAssistantModal()">å–æ¶ˆ</button>
							<button type="submit" class="btn btn-save">ä¿å­˜</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div id="task-modal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<h3>åˆ›å»ºæ–°ä»»åŠ¡</h3>
					<button class="close-btn" onclick="closeTaskModal()">Ã—</button>
				</div>
				<div class="modal-body">
					<form id="task-form">
						<div class="form-group">
							<label for="taskType">ä»»åŠ¡ç±»å‹</label>
							<select id="taskType" name="taskType" required>
								<option value="">è¯·é€‰æ‹©ä»»åŠ¡ç±»å‹</option>
								<option value="æ–‡æœ¬ç”Ÿæˆ">æ–‡æœ¬ç”Ÿæˆ</option>
								<option value="å›¾åƒå¤„ç†">å›¾åƒå¤„ç†</option>
								<option value="æ•°æ®åˆ†æ">æ•°æ®åˆ†æ</option>
								<option value="è¯­éŸ³è¯†åˆ«">è¯­éŸ³è¯†åˆ«</option>
							</select>
						</div>
						<div class="form-group">
							<label for="taskContent">ä»»åŠ¡å†…å®¹</label>
							<textarea id="taskContent" name="taskContent" rows="5" placeholder="è¯·è¾“å…¥ä»»åŠ¡çš„å…·ä½“æè¿°..."
								required></textarea>
						</div>
						<div class="btn-group">
							<button type="button" class="btn btn-cancel" onclick="closeTaskModal()">å–æ¶ˆ</button>
							<button type="submit" class="btn btn-save">æäº¤ä»»åŠ¡</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div id="multi-assign-modal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<h3>å¤šåŠ©æ‰‹åä½œåˆ†é…</h3>
					<button class="close-btn" onclick="closeMultiAssignModal()">Ã—</button>
				</div>
				<div class="modal-body">
					<form id="multi-assign-form">
						<div class="form-group">
							<label>é€‰æ‹©åä½œåŠ©æ‰‹ (å¯å¤šé€‰)</label>
							<div id="assistant-checkbox-list"
								style="max-height: 300px; overflow-y: auto; border: 1px solid #e0e0e0; border-radius: 8px; padding: 12px;">
								<p style="color: #999; text-align: center;">æ­£åœ¨åŠ è½½åŠ©æ‰‹åˆ—è¡¨...</p>
							</div>
						</div>
						<div class="btn-group">
							<button type="button" class="btn btn-cancel" onclick="closeMultiAssignModal()">å–æ¶ˆ</button>
							<button type="submit" class="btn btn-save">ç¡®è®¤åˆ†é…</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<script>
			// åç«¯ API åŸºç¡€ URL (å·²æ›´æ–°ä¸ºæŒ‡å®šçš„åç«¯ç«¯å£)
			const BASE_URL = 'http://localhost:8080/api';

			// å½“å‰ç¼–è¾‘çš„åŠ©æ‰‹ID,ç”¨äºåŒºåˆ†æ–°å¢å’Œç¼–è¾‘
			let currentAssistantId = null;

			// å½“å‰è¿›è¡Œå¤šåŠ©æ‰‹åä½œåˆ†é…çš„ä»»åŠ¡ID
			let currentTaskIdForMultiAssign = null;

			// Chart.js å®ä¾‹
			let taskChartInstance = null;

			// --- é€šç”¨ API å·¥å…·å‡½æ•° ---

			/**
			 * ç»Ÿä¸€å¤„ç†å‰åç«¯æ•°æ®äº¤äº’
			 * @param {string} endpoint - API è·¯å¾„,ä¾‹å¦‚ '/stats' æˆ– '/assistant/1'
			 * @param {string} [method='GET'] - HTTP æ–¹æ³•
			 * @param {object} [data=null] - è¦å‘é€çš„è¯·æ±‚ä½“æ•°æ®
			 */
			async function fetchData(endpoint, method = 'GET', data = null) {
				const url = `${BASE_URL}${endpoint}`;
				const options = {
					method: method,
					headers: {
						'Content-Type': 'application/json',
					},
				};

				if (data && (method === 'POST' || method === 'PUT')) {
					options.body = JSON.stringify(data);
				}

				try {
					const response = await fetch(url, options);

					if (!response.ok) {
						const errorText = await response.text();
						const errorMessage = errorText.length < 500 ? errorText : response.statusText;
						throw new Error(`API è¯·æ±‚å¤±è´¥ (${response.status}): ${errorMessage}`);
					}

					if (response.status === 204 || (response.headers.get('content-length') === '0' && response.status !==
							200)) {
						return null;
					}

					return await response.json();
				} catch (error) {
					console.error(`è¯·æ±‚ ${method} ${url} å¤±è´¥:`, error);
					// ä½¿ç”¨æ›´å‹å¥½çš„æ–¹å¼æé†’ç”¨æˆ·
					alert('æ“ä½œå¤±è´¥æˆ–åç«¯æœåŠ¡ä¸å¯ç”¨,è¯·æ£€æŸ¥æ§åˆ¶å°å’Œç½‘ç»œè¿æ¥ã€‚é”™è¯¯: ' + error.message);
					throw error;
				}
			}

			// --- è§†å›¾åˆ‡æ¢å’Œåˆå§‹åŒ– ---

			/**
			 * åˆ‡æ¢é¡µé¢è§†å›¾,å¹¶æ ¹æ®è§†å›¾åŠ è½½æ•°æ®
			 */
			function showSection(sectionId) {
				document.querySelectorAll('.section').forEach(section => {
					section.style.display = 'none';
				});
				document.getElementById(`${sectionId}-section`).style.display = 'block';

				// æ¿€æ´»ä¾§è¾¹æ é“¾æ¥
				document.querySelectorAll('.nav-link').forEach(link => {
					link.classList.remove('active');
					if (link.getAttribute('href') === `#${sectionId}`) {
						link.classList.add('active');
					}
				});

				// åˆ‡æ¢è§†å›¾æ—¶åŠ è½½æ•°æ®
				switch (sectionId) {
					case 'dashboard':
						fetchStats();
						fetchTasks(); // åŠ è½½å¾…å¤„ç†ä»»åŠ¡
						break;
					case 'stats':
						loadDetailedStats();
						break;
					case 'assistants':
						fetchAssistants();
						break;
					case 'tasks':
						fetchTasks();
						break;
					case 'logs':
						fetchLogs();
						break;
				}
			}

			// --- ç»Ÿè®¡æ•°æ® (StatsController) ---

			const statAssistantCount = document.getElementById('stat-assistant-count');
			const statCompletedCount = document.getElementById('stat-completed-count');
			const statRunningCount = document.getElementById('stat-running-count');
			const statLogCount = document.getElementById('stat-log-count');

			async function fetchStats() {
				try {
					// API: GET http://localhost:8080/api/stats
					const stats = await fetchData('/stats');
					if (!stats) return;

					// æ ¹æ®åç«¯StatsService.javaè¿”å›çš„å­—æ®µåæ˜ å°„
					statAssistantCount.textContent = stats.totalAssistants ?? '0';
					statCompletedCount.textContent = stats.completedTasks ?? '0';
					statRunningCount.textContent = stats.runningTasks ?? '0';

					// æ—¥å¿—æ€»æ•°éœ€è¦å•ç‹¬è·å–
					fetchLogCount();

					// æ›´æ–°å›¾è¡¨æ•°æ®
					updateTaskChart(stats);

				} catch (error) {
					// é”™è¯¯å·²åœ¨ fetchData ä¸­å¤„ç†
				}
			}

			/**
			 * æ›´æ–°ä»»åŠ¡åˆ†å¸ƒå›¾è¡¨
			 */
			function updateTaskChart(stats) {
				const ctx = document.getElementById('taskChart');
				if (!ctx) return;

				if (taskChartInstance) {
					taskChartInstance.destroy();
				}

				const total = (stats.waitingTasks ?? 0) + (stats.runningTasks ?? 0) +
					(stats.completedTasks ?? 0) + (stats.failedTasks ?? 0);

				// æ ¹æ®å›¾ç‰‡ä¸­çš„é¢œè‰²å’Œä»»åŠ¡çŠ¶æ€æ˜ å°„å…³ç³»è¿›è¡Œä¿®æ”¹:
				// ä»»åŠ¡çŠ¶æ€é¡ºåº: ['ç­‰å¾…ä¸­', 'è¿è¡Œä¸­', 'å·²å®Œæˆ', 'å¤±è´¥']
				// å¯¹åº”é¢œè‰²é¡ºåº: [é‡‡è´­æˆæœ¬(ç°), æ¨å¹¿è´¹(æ©™), å‘è´§è´¹(è“), ä¿ƒé”€è´¹(ç»¿)]
				const BACKGROUND_COLORS = [
					'#6c757d', // ç° (ç­‰å¾…ä¸­)
					'#6dca37', // æ©™ (è¿è¡Œä¸­)
					'#007bff', // è“ (å·²å®Œæˆ)
					'#ff4040' // çº¢ (å¤±è´¥)
				];

				const chartData = {
					labels: ['ç­‰å¾…ä¸­', 'è¿è¡Œä¸­', 'å·²å®Œæˆ', 'å¤±è´¥'],
					datasets: [{
						data: [
							stats.waitingTasks ?? 0,
							stats.runningTasks ?? 0,
							stats.completedTasks ?? 0,
							stats.failedTasks ?? 0
						],
						// ä½¿ç”¨å›¾ç‰‡ä¸­çš„çº¯è‰²æ›¿ä»£åŸæ¥çš„æ¸å˜è‰²
						backgroundColor: BACKGROUND_COLORS,
						borderWidth: 2
					}]
				};

				taskChartInstance = new Chart(ctx, {
					type: 'doughnut',
					data: chartData,
					options: {
						responsive: true,
						maintainAspectRatio: false,
						cutout: '70%', // ç¯å½¢å®½åº¦
						plugins: {
							legend: {
								position: 'bottom',
								labels: {
									usePointStyle: true,
									pointStyle: 'circle',
									padding: 20,
									font: {
										size: 13
									}
								}
							},
							tooltip: {
								backgroundColor: 'rgba(50,50,50,0.8)',
								titleColor: '#fff',
								bodyColor: '#fff',
								bodyFont: {
									weight: 'bold'
								},
								callbacks: {
									label: function(context) {
										const value = context.parsed;
										const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
										return `${context.label}: ${value} (${percentage}%)`;
									}
								}
							},
							// åœ¨åœ†å¿ƒæ˜¾ç¤ºæ€»æ•°
							beforeDraw: chart => {
								const {
									width
								} = chart;
								const {
									height
								} = chart;
								const ctx = chart.ctx;
								ctx.restore();
								ctx.font = "bold 18px Segoe UI";
								ctx.fillStyle = "#4285f4";
								ctx.textAlign = "center";
								ctx.textBaseline = "middle";
								ctx.fillText(`æ€»æ•° ${total}`, width / 2, height / 2);
								ctx.save();
							}
						}
					}
				});
			}



			/**
			 * è·å–æ—¥å¿—æ€»æ•°
			 */
			async function fetchLogCount() {
				try {
					const logs = await fetchData('/log');
					statLogCount.textContent = (logs || []).length;
				} catch (error) {
					statLogCount.textContent = '0';
				}
			}

			/**
			 * åŠ è½½è¯¦ç»†ç»Ÿè®¡æ•°æ®åˆ°ç»Ÿè®¡ä¸­å¿ƒé¡µé¢
			 */
			async function loadDetailedStats() {
				try {
					const stats = await fetchData('/stats');
					if (!stats) return;

					// åŠ©æ‰‹ç»Ÿè®¡
					document.getElementById('stats-total-assistants').textContent = stats.totalAssistants ?? '0';
					document.getElementById('stats-online-assistants').textContent = stats.onlineAssistants ?? '0';
					document.getElementById('stats-offline-assistants').textContent = stats.offlineAssistants ?? '0';
					document.getElementById('stats-avg-score').textContent = stats.averageScore ?? '0.00';

					// ä»»åŠ¡ç»Ÿè®¡
					document.getElementById('stats-total-tasks').textContent = stats.totalTasks ?? '0';
					document.getElementById('stats-completed-tasks').textContent = stats.completedTasks ?? '0';
					document.getElementById('stats-running-tasks').textContent = stats.runningTasks ?? '0';
					document.getElementById('stats-waiting-tasks').textContent = stats.waitingTasks ?? '0';

					// æˆåŠŸç‡
					document.getElementById('stats-success-rate').textContent = stats.taskSuccessRate ?? '0.00%';

				} catch (error) {
					console.error('åŠ è½½è¯¦ç»†ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
				}
			}

			// --- æ™ºèƒ½åŠ©æ‰‹ç®¡ç† (AssistantController) ---

			const assistantsTableBody = document.getElementById('assistants-table-body');

			async function fetchAssistants() {
				try {
					// API: GET http://localhost:8080/api/assistant
					const assistants = await fetchData('/assistant');
					renderAssistants(assistants || []);
				} catch (error) {}
			}

			function renderAssistants(assistants) {
				assistantsTableBody.innerHTML = ''; // æ¸…ç©ºç°æœ‰æ•°æ®

				if (assistants.length === 0) {
					assistantsTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">æš‚æ— åŠ©æ‰‹æ•°æ®</td></tr>';
					return;
				}

				assistants.forEach(assistant => {
					// åç«¯ Assistant.java ä¸­ online æ˜¯ Boolean ç±»å‹
					const statusClass = assistant.online ? 'status-online' : 'status-offline';
					const statusText = assistant.online ? 'åœ¨çº¿' : 'ç¦»çº¿';

					// æ·»åŠ å¯åŠ¨/åœæ­¢æœåŠ¡æŒ‰é’®
					const serviceButton = assistant.online ?
						`<button onclick="stopAssistantService(${assistant.id})" class="btn btn-assistant btn-stop-service">åœæ­¢æœåŠ¡</button>` :
						`<button onclick="startAssistantService(${assistant.id})" class="btn btn-assistant btn-start-service">å¯åŠ¨æœåŠ¡</button>`;

					const row = `
                                    <tr>
                                        <td>${assistant.id}</td>
                                        <td>${assistant.name}</td>
                                        <td>${assistant.type}</td>
                                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                                        <td>${assistant.score}</td>
                                        <td>
                                            ${serviceButton}
                                            <button onclick="editAssistant(${assistant.id})" class="btn btn-assistant btn-edit-assistant">ç¼–è¾‘</button>
                                            <button onclick="deleteAssistant(${assistant.id})" class="btn btn-assistant btn-delete-assistant">åˆ é™¤</button>
                                        </td>
                                    </tr>
                                `;
					assistantsTableBody.insertAdjacentHTML('beforeend', row);
				});
			}

			const assistantModal = document.getElementById('assistant-modal');
			const assistantModalTitle = document.getElementById('assistant-modal-title');
			const assistantForm = document.getElementById('assistant-form');
			const assistantNameInput = document.getElementById('assistantName');
			const assistantTypeInput = document.getElementById('assistantType');
			const assistantVersionInput = document.getElementById('assistantVersion');
			const assistantScoreInput = document.getElementById('assistantScore');
			const assistantOnlineCheckbox = document.getElementById('assistantOnline');

			function openAssistantModal(assistant = null) {
				if (assistant) {
					// ç¼–è¾‘æ¨¡å¼
					assistantModalTitle.textContent = 'ç¼–è¾‘æ™ºèƒ½åŠ©æ‰‹';
					currentAssistantId = assistant.id;
					assistantNameInput.value = assistant.name;
					assistantTypeInput.value = assistant.type;
					assistantVersionInput.value = assistant.version || '';
					assistantOnlineCheckbox.checked = !!assistant.online; // ç¡®ä¿æ˜¯å¸ƒå°”å€¼
					assistantScoreInput.value = assistant.score || 0;
				} else {
					// æ–°å¢æ¨¡å¼
					assistantModalTitle.textContent = 'åˆ›å»ºæ–°åŠ©æ‰‹';
					currentAssistantId = null;
					assistantForm.reset();
					assistantOnlineCheckbox.checked = true; // æ–°å»ºæ—¶é»˜è®¤åœ¨çº¿
				}
				assistantModal.style.display = 'block';
			}

			function closeAssistantModal() {
				assistantModal.style.display = 'none';
				currentAssistantId = null;
			}

			async function editAssistant(id) {
				try {
					// API: GET http://localhost:8080/api/assistant/{id}
					const assistant = await fetchData(`/assistant/${id}`);
					if (assistant) {
						openAssistantModal(assistant);
					}
				} catch (error) {}
			}

			assistantForm.addEventListener('submit', async function(e) {
				e.preventDefault();

				const form = e.target;
				const assistantData = {
					// ID ç”±åç«¯è‡ªåŠ¨ç”Ÿæˆ,ä½†ç¼–è¾‘æ—¶éœ€è¦ä¼ å›
					id: currentAssistantId,
					name: form.assistantName.value,
					type: form.assistantType.value,
					version: form.assistantVersion.value,
					online: form.assistantOnline.checked, // å‘é€å¸ƒå°”å€¼
					score: parseInt(form.assistantScore.value, 10) || 0
				};

				try {
					if (currentAssistantId) {
						// API: PUT http://localhost:8080/api/assistant/{id}
						await fetchData(`/assistant/${currentAssistantId}`, 'PUT', assistantData);
						alert('åŠ©æ‰‹æ›´æ–°æˆåŠŸ!');
					} else {
						// API: POST http://localhost:8080/api/assistant
						await fetchData('/assistant', 'POST', assistantData);
						alert('åŠ©æ‰‹åˆ›å»ºæˆåŠŸ!');
					}
					closeAssistantModal();
					fetchAssistants(); // åˆ·æ–°åˆ—è¡¨
				} catch (error) {}
			});

			async function deleteAssistant(id) {
				if (!confirm('ç¡®å®šè¦åˆ é™¤è¯¥åŠ©æ‰‹å—?æ­¤æ“ä½œä¸å¯é€†!')) return;

				try {
					// API: DELETE http://localhost:8080/api/assistant/{id}
					await fetchData(`/assistant/${id}`, 'DELETE');
					alert('åŠ©æ‰‹åˆ é™¤æˆåŠŸ!');
					fetchAssistants(); // åˆ·æ–°åˆ—è¡¨
				} catch (error) {}
			}

			/**
			 * å¯åŠ¨AIåŠ©æ‰‹æœåŠ¡
			 */
			async function startAssistantService(id) {
				try {
					// API: PUT http://localhost:8080/api/assistant/{id}/start
					const assistant = await fetchData(`/assistant/${id}/start`, 'PUT');
					alert(`åŠ©æ‰‹ ${assistant.name} å·²å¯åŠ¨æœåŠ¡,å½“å‰çŠ¶æ€: åœ¨çº¿`);
					fetchAssistants(); // åˆ·æ–°åˆ—è¡¨
				} catch (error) {}
			}

			/**
			 * åœæ­¢AIåŠ©æ‰‹æœåŠ¡
			 */
			async function stopAssistantService(id) {
				try {
					// API: PUT http://localhost:8080/api/assistant/{id}/stop
					const assistant = await fetchData(`/assistant/${id}/stop`, 'PUT');
					alert(`åŠ©æ‰‹ ${assistant.name} å·²åœæ­¢æœåŠ¡,å½“å‰çŠ¶æ€: ç¦»çº¿`);
					fetchAssistants(); // åˆ·æ–°åˆ—è¡¨
				} catch (error) {}
			}

			// --- ä»»åŠ¡é˜Ÿåˆ—ç®¡ç† (TaskQueueController & TaskAssignmentController) ---

			const waitingList = document.getElementById('waiting-list');
			const runningList = document.getElementById('running-list');
			const completedList = document.getElementById('completed-list');

			async function fetchTasks() {
				try {
					// API: GET http://localhost:8080/api/task/queue
					// åç«¯è¿”å›æ ¼å¼: { "waiting": [Task...], "running": [Task...], "completed": [Task...] }
					const tasksByStatus = await fetchData('/task/queue');

					if (!tasksByStatus) {
						renderTasks('waiting', []);
						renderTasks('running', []);
						renderTasks('completed', []);
						return;
					}

					renderTasks('waiting', tasksByStatus.waiting || []);
					renderTasks('running', tasksByStatus.running || []);
					renderTasks('completed', tasksByStatus.completed || []);

				} catch (error) {}
			}

			function renderTasks(statusKey, tasks) {
				const listElement = document.getElementById(`${statusKey}-list`);
				if (!listElement) return;

				listElement.innerHTML = ''; // æ¸…ç©ºç°æœ‰æ•°æ®

				if (tasks.length === 0) {
					listElement.innerHTML =
						`<div style="padding: 12px; color: #999; text-align: center;">æš‚æ—  ${statusKey} ä»»åŠ¡</div>`;
					return;
				}

				const statusMap = {
					'waiting': {
						class: 'status-waiting',
						text: 'ç­‰å¾…ä¸­'
					},
					'running': {
						class: 'status-running',
						text: 'æ‰§è¡Œä¸­'
					},
					'completed': {
						class: 'status-completed',
						text: 'å·²å®Œæˆ'
					},
					'failed': {
						class: 'status-failed',
						text: 'å¤±è´¥'
					}
				};

				tasks.forEach(task => {
					// TaskQueue.java ä¸­ status æ˜¯ String
					const statusInfo = statusMap[task.status] || {
						class: 'status-waiting',
						text: 'æœªçŸ¥çŠ¶æ€'
					};
					// åç«¯è¿”å›çš„æ˜¯ ISO æ ¼å¼çš„ createTime å­—ç¬¦ä¸²
					const timeDisplay = task.createTime ? new Date(task.createTime).toLocaleTimeString('zh-CN', {
						hour: '2-digit',
						minute: '2-digit'
					}) : 'N/A';

					// ä»»åŠ¡æ“ä½œæŒ‰é’®
					let actions = '';
					if (task.status === 'waiting') {
						// è‡ªåŠ¨åˆ†é…æŒ‰é’®å’Œå¤šåŠ©æ‰‹åä½œæŒ‰é’®
						actions = `
                                        <button onclick="assignTaskAuto(${task.id})" class="btn-task btn-assign-auto">è‡ªåŠ¨åˆ†é…</button>
                                        <button onclick="openMultiAssignModal(${task.id})" class="btn-task btn-multi-assign">å¤šåŠ©æ‰‹åä½œ</button>
                                    `;
					} else if (task.status === 'running') {
						// æ ‡è®°å®Œæˆå’Œæ ‡è®°å¤±è´¥æŒ‰é’®
						actions = `
                                        <button onclick="updateTaskStatus(${task.id}, 'completed')" class="btn-task btn-mark-complete">æ ‡è®°å®Œæˆ</button>
                                        <button onclick="updateTaskStatus(${task.id}, 'failed')" class="btn-task btn-mark-failed">æ ‡è®°å¤±è´¥</button>
                                    `;
					}

					const item = `
                                    <div class="schedule-item">
                                        <div class="schedule-status ${statusInfo.class}"></div>
                                        <div class="schedule-time">${timeDisplay}</div>
                                        <div class="schedule-content">
                                            <div class="schedule-title">${task.content.substring(0, 50)}${task.content.length > 50 ? '...' : ''}</div>
                                            <div class="schedule-subtitle">åˆ†é…ç»™: ${task.assignedTo || 'æœªåˆ†é…'}</div>
                                        </div>
                                        <div class="schedule-actions">${actions}</div>
                                    </div>
                                `;
					listElement.insertAdjacentHTML('beforeend', item);
				});
			}

			const taskModal = document.getElementById('task-modal');
			const taskForm = document.getElementById('task-form');

			function openTaskModal() {
				taskForm.reset();
				taskModal.style.display = 'block';
			}

			function closeTaskModal() {
				taskModal.style.display = 'none';
			}

			taskForm.addEventListener('submit', async function(e) {
				e.preventDefault();

				const form = e.target;
				const taskData = {
					type: form.taskType.value, // æ–°å¢ä»»åŠ¡ç±»å‹å­—æ®µ
					content: form.taskContent.value
				};

				try {
					// API: POST http://localhost:8080/api/task (ç”± TaskQueueController å¤„ç†)
					await fetchData('/task', 'POST', taskData);
					alert('ä»»åŠ¡æäº¤æˆåŠŸ,ç­‰å¾…åˆ†é…ã€‚');
					closeTaskModal();
					// åˆ·æ–°ä»ªè¡¨ç›˜å’Œä»»åŠ¡è§†å›¾
					if (document.getElementById('dashboard-section').style.display !== 'none' ||
						document.getElementById('tasks-section').style.display !== 'none') {
						fetchTasks();
					}
				} catch (error) {}
			});

			/**
			 * è°ƒç”¨åç«¯è‡ªåŠ¨åˆ†é…ä»»åŠ¡æ¥å£
			 */
			async function assignTaskAuto(taskId) {
				try {
					// API: POST http://localhost:8080/api/assign/auto/{taskId} (ç”± TaskAssignmentController å¤„ç†)
					const updatedTask = await fetchData(`/assign/auto/${taskId}`, 'POST');
					alert(`ä»»åŠ¡ ${taskId} å·²è‡ªåŠ¨åˆ†é…ç»™ ${updatedTask.assignedTo || 'åŠ©æ‰‹'},çŠ¶æ€æ›´æ–°ä¸ºè¿è¡Œä¸­!`);
					fetchTasks(); // åˆ·æ–°ä»»åŠ¡åˆ—è¡¨
				} catch (error) {}
			}

			/**
			 * æ›´æ–°ä»»åŠ¡çŠ¶æ€
			 */
			async function updateTaskStatus(taskId, newStatus) {
				try {
					// API: PUT http://localhost:8080/api/task/{id}/status?status={newStatus} (ç”± TaskQueueController å¤„ç†)
					await fetchData(`/task/${taskId}/status?status=${newStatus}`, 'PUT');
					alert(`ä»»åŠ¡ ${taskId} çŠ¶æ€å·²æ›´æ–°ä¸º ${newStatus}!`);
					fetchTasks(); // åˆ·æ–°ä»»åŠ¡åˆ—è¡¨
				} catch (error) {}
			}

			// --- å¤šåŠ©æ‰‹åä½œåŠŸèƒ½ ---

			const multiAssignModal = document.getElementById('multi-assign-modal');
			const assistantCheckboxList = document.getElementById('assistant-checkbox-list');
			const multiAssignForm = document.getElementById('multi-assign-form');

			/**
			 * æ‰“å¼€å¤šåŠ©æ‰‹åä½œåˆ†é…æ¨¡æ€æ¡†
			 */
			async function openMultiAssignModal(taskId) {
				currentTaskIdForMultiAssign = taskId;
				multiAssignModal.style.display = 'block';

				try {
					// è·å–æ‰€æœ‰åœ¨çº¿åŠ©æ‰‹
					const assistants = await fetchData('/assistant');
					const onlineAssistants = (assistants || []).filter(a => a.online);

					if (onlineAssistants.length === 0) {
						assistantCheckboxList.innerHTML = '<p style="color: #999; text-align: center;">æš‚æ— åœ¨çº¿åŠ©æ‰‹å¯ä¾›é€‰æ‹©</p>';
						return;
					}

					// æ¸²æŸ“åŠ©æ‰‹å¤é€‰æ¡†åˆ—è¡¨
					assistantCheckboxList.innerHTML = '';
					onlineAssistants.forEach(assistant => {
						const item = `
                                        <div class="checkbox-group" style="margin-bottom: 12px; padding: 8px; border: 1px solid #f0f0f0; border-radius: 6px;">
                                            <input type="checkbox" id="assistant-${assistant.id}" value="${assistant.id}">
                                            <label for="assistant-${assistant.id}" style="margin-bottom: 0; cursor: pointer; flex: 1;">
                                                ${assistant.name} (${assistant.type}) - è¯„åˆ†: ${assistant.score}
                                            </label>
                                        </div>
                                    `;
						assistantCheckboxList.insertAdjacentHTML('beforeend', item);
					});
				} catch (error) {
					assistantCheckboxList.innerHTML = '<p style="color: #d32f2f; text-align: center;">åŠ è½½åŠ©æ‰‹åˆ—è¡¨å¤±è´¥</p>';
				}
			}

			/**
			 * å…³é—­å¤šåŠ©æ‰‹åä½œæ¨¡æ€æ¡†
			 */
			function closeMultiAssignModal() {
				multiAssignModal.style.display = 'none';
				currentTaskIdForMultiAssign = null;
			}

			/**
			 * æäº¤å¤šåŠ©æ‰‹åä½œåˆ†é…
			 */
			multiAssignForm.addEventListener('submit', async function(e) {
				e.preventDefault();

				// è·å–æ‰€æœ‰é€‰ä¸­çš„åŠ©æ‰‹ID
				const checkboxes = document.querySelectorAll(
					'#assistant-checkbox-list input[type="checkbox"]:checked');
				const assistantIds = Array.from(checkboxes).map(cb => parseInt(cb.value, 10));

				if (assistantIds.length === 0) {
					alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªåŠ©æ‰‹è¿›è¡Œåä½œ!');
					return;
				}

				try {
					// API: POST http://localhost:8080/api/assign/multi/{taskId}
					// æ³¨æ„: åç«¯è¦æ±‚å°† assistantIds æ•°ç»„ä½œä¸ºè¯·æ±‚ä½“å‘é€
					await fetchData(`/assign/multi/${currentTaskIdForMultiAssign}`, 'POST', assistantIds);
					alert(`ä»»åŠ¡å·²æˆåŠŸåˆ†é…ç»™ ${assistantIds.length} ä¸ªåŠ©æ‰‹åä½œå¤„ç†!`);
					closeMultiAssignModal();
					fetchTasks(); // åˆ·æ–°ä»»åŠ¡åˆ—è¡¨
				} catch (error) {}
			});

			// --- æ—¥å¿—ä¸­å¿ƒ (LogController) ---

			const logsTableBody = document.getElementById('logs-table-body');

			async function fetchLogs() {
				try {
					// API: GET http://localhost:8080/api/log
					const logs = await fetchData('/log');
					renderLogs(logs || []);
				} catch (error) {}
			}

			function renderLogs(logs) {
				logsTableBody.innerHTML = ''; // æ¸…ç©ºç°æœ‰æ•°æ®

				if (logs.length === 0) {
					logsTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">æš‚æ— æ“ä½œæ—¥å¿—</td></tr>';
					return;
				}

				logs.forEach(log => {
					// Log.java ä¸­ status æ˜¯ String
					const statusClass = log.status === 'æˆåŠŸ' ? 'status-completed' : 'status-failed';
					const timeDisplay = log.createTime ? new Date(log.createTime).toLocaleString('zh-CN', {
						hour12: false
					}) : 'N/A';

					const row = `
                                    <tr>
                                        <td>${log.id}</td>
                                        <td>${log.taskId || 'N/A'}</td>
                                        <td>${log.assistantId || 'N/A'}</td>
                                        <td>${log.action}</td>
                                        <td><span class="status-badge ${statusClass}">${log.status}</span></td>
                                        <td>${timeDisplay}</td>
                                    </tr>
                                `;
					logsTableBody.insertAdjacentHTML('beforeend', row);
				});
			}

			// --- é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– ---
			document.addEventListener('DOMContentLoaded', function() {
				// é»˜è®¤æ˜¾ç¤ºä»ªè¡¨ç›˜
				showSection('dashboard');
			});
		</script>
	</body>
</html>